function dn42_import_filter() {
  if ! bgp_base_import_filter() then {
    return false;
  }
  if is_valid_net42() && !is_self_net42() && !roa_dn42_ck() then {
    return true;
  }
  return false;
};

function dn42_peer_import_filter() {
  if bgp_path.len != 1 then {
    return false;
  }
  return dn42_import_filter();
};

function dn42_export_filter() {
  if ! bgp_base_export_filter() then {
    return false;
  }
  if is_valid_net42() && source ~ [ RTS_BGP, RTS_STATIC ] then {
    community_export_dn42();
    return true;
  }
  return false;
};

function dn42_peer_export_filter() {
  if !is_self_net42() then {
    return false;
  }
  bgp_community.add((65535, 65281));
  return dn42_export_filter();
};

function dn42_downstream_import_filter() {
  community_import_downstream_dn42();
  return dn42_peer_import_filter();
};

function dn42_downstream_export_filter() {
  if !is_self_net42() && !community_ptype_allow_downstream() then {
    return false;
  }
  if is_self_net42() then bgp_community.add((65535, 65281));
  return dn42_export_filter();
};

function dn42_transit_import_filter() {
  community_import_transit_dn42();
  return dn42_import_filter();
}

function dn42_transit_export_filter() {
  if !is_self_net42() && !community_ptype_allow_transit() then {
    return false;
  }
  return dn42_export_filter();
}

function dn42_upstream_import_filter() {
  community_import_upstream_dn42();
  return dn42_import_filter();
};

function dn42_upstream_export_filter() {
  if !is_self_net42() && !community_ptype_allow_upstream() then {
    return false;
  }
  return dn42_export_filter();
};

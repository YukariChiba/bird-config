function iana_import_filter() {
  if ! bgp_base_import_filter() then {
    return false;
  }
  if is_valid_net() && !is_self_net() && !roa_iana_ck() then {
    return true;
  }
  return false;
};

function iana_peer_import_filter() {
  if bgp_path.len != 1 then {
    return false;
  }
  return iana_import_filter();
};

function iana_export_filter() {
  if ! bgp_base_export_filter() then {
    return false;
  }
  if is_valid_net() && source ~ [ RTS_BGP, RTS_STATIC ] then {
    community_export_iana();
    return true;
  }
  return false;
};

function iana_peer_export_filter() {
  if !is_self_net42() then {
    return false;
  }
  bgp_community.add((65535, 65281));
  return iana_export_filter();
};

function iana_downstream_import_filter() {
  community_import_downstream_iana();
  return iana_peer_import_filter();
};

function iana_downstream_export_filter() {
  if is_self_net() then bgp_community.add((65535, 65281));
  return iana_export_filter();
};

